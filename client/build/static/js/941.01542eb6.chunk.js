"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[941],{96941:(e,t,a)=>{a.r(t),a.d(t,{default:()=>L});var n=a(65043),s=a(84892),l=a(24702),i=a(94406),r=a(44394),d=a(47419),o=a(11645),c=a(5397),h=a(26655),x=a(98166),u=a(50108),m=a(75748),j=a(87734),y=a(52185),p=a(6026),g=a(86150),A=a(21327),f=a(90168),b=a(60163),v=a(4240),S=a(17869),w=a(82291),k=a(38643),D=a(86178),$=a.n(D),F=a(86213);const K=()=>{const e=localStorage.getItem("token");return e?{Authorization:`Bearer ${e}`}:{}};var R=a(70579);const{Title:Y}=s.A,{RangePicker:E}=l.A,{Option:C}=i.A,I=["#0088FE","#00C49F","#FFBB28","#FF8042","#A64D79"],L=()=>{const[e,t]=(0,n.useState)(!0),[a,s]=(0,n.useState)(null),[l,D]=(0,n.useState)([$()().subtract(1,"year"),$()()]),[L,z]=(0,n.useState)("all"),[B,M]=(0,n.useState)("month"),[P,W]=(0,n.useState)([]),[N,O]=(0,n.useState)([]),[T,U]=(0,n.useState)([]),[q,V]=(0,n.useState)([]),[G,H]=(0,n.useState)([]),[J,Q]=(0,n.useState)([]),[X,Z]=(0,n.useState)(window.innerWidth<=768);(0,n.useEffect)((()=>{const e=()=>{Z(window.innerWidth<=768)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);(0,n.useEffect)((()=>{(async()=>{try{t(!0),s(null);const e=new URLSearchParams;e.append("startDate",l[0].format("YYYY-MM-DD")),e.append("endDate",l[1].format("YYYY-MM-DD")),"all"!==L&&e.append("department",L),e.append("timeUnit",B);const a=(await F.A.get(`http://localhost:5000/api/reports/statistics?${e.toString()}`,{headers:K()})).data;W(a.timeDistribution||[]),O(a.departmentDistribution||[]),U(a.statusDistribution||[]),V(a.teamDistribution||[]),H(a.typeDistribution||[]),Q(a.topContributors||[])}catch(e){console.error("\u83b7\u53d6\u62a5\u8868\u6570\u636e\u5931\u8d25:",e),s("\u83b7\u53d6\u62a5\u8868\u6570\u636e\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}finally{t(!1)}})()}),[L,B,l]);return(0,R.jsxs)("div",{className:"responsive-container",style:{padding:X?12:16},children:[(0,R.jsx)(Y,{level:X?3:2,children:"\u7edf\u8ba1\u62a5\u8868"}),a&&(0,R.jsx)(r.A,{message:"\u83b7\u53d6\u6570\u636e\u5931\u8d25",description:a,type:"error",style:{marginBottom:16},closable:!0}),(0,R.jsxs)(d.A,{gutter:[X?8:16,X?8:16],style:{marginBottom:X?12:16},children:[(0,R.jsx)(o.A,{xs:24,sm:24,md:8,children:(0,R.jsxs)(i.A,{defaultValue:"all",style:{width:"100%"},value:L,onChange:e=>z(e),children:[(0,R.jsx)(C,{value:"all",children:"\u6240\u6709\u90e8\u95e8"}),(0,R.jsx)(C,{value:"SAFETY",children:"\u5b89\u5168\u79d1"}),(0,R.jsx)(C,{value:"OPERATION",children:"\u8fd0\u884c\u79d1"})]})}),(0,R.jsx)(o.A,{xs:24,sm:12,md:8,children:(0,R.jsxs)(i.A,{style:{width:"100%"},value:B,onChange:e=>M(e),children:[(0,R.jsx)(C,{value:"year",children:"\u6309\u5e74\u5ea6\u7edf\u8ba1"}),(0,R.jsx)(C,{value:"quarter",children:"\u6309\u5b63\u5ea6\u7edf\u8ba1"}),(0,R.jsx)(C,{value:"month",children:"\u6309\u6708\u5ea6\u7edf\u8ba1"}),(0,R.jsx)(C,{value:"week",children:"\u6309\u5468\u7edf\u8ba1"})]})}),(0,R.jsx)(o.A,{xs:24,sm:12,md:8,children:(0,R.jsx)(E,{value:l,onChange:e=>{e&&2===e.length&&D(e)},style:{width:"100%"}})})]}),(0,R.jsx)(c.A,{spinning:e,children:(0,R.jsxs)(d.A,{gutter:[X?8:16,X?12:16],children:[(0,R.jsx)(o.A,{span:24,children:(0,R.jsx)(h.A,{title:"\u5efa\u8bae\u63d0\u4ea4\u8d8b\u52bf",bodyStyle:{padding:X?8:24},children:(0,R.jsx)(u.u,{width:"100%",height:X?250:300,children:(0,R.jsxs)(m.b,{data:P,margin:{top:5,right:30,left:X?0:20,bottom:5},children:[(0,R.jsx)(j.d,{strokeDasharray:"3 3"}),(0,R.jsx)(y.W,{dataKey:"timePeriod"}),(0,R.jsx)(p.h,{}),(0,R.jsx)(g.m,{}),(0,R.jsx)(A.s,{}),(0,R.jsx)(f.N,{type:"monotone",dataKey:"count",name:"\u5efa\u8bae\u6570\u91cf",stroke:"#8884d8",activeDot:{r:8}})]})})})}),(0,R.jsx)(o.A,{xs:24,sm:24,md:12,children:(0,R.jsx)(h.A,{title:"\u5404\u73ed\u7ec4\u5efa\u8bae\u5206\u5e03",bodyStyle:{padding:X?8:24},children:(0,R.jsx)(u.u,{width:"100%",height:X?250:300,children:(0,R.jsxs)(b.r,{children:[(0,R.jsx)(v.F,{data:q,cx:"50%",cy:"50%",labelLine:!X,outerRadius:X?60:80,fill:"#8884d8",dataKey:"value",nameKey:"name",label:X?null:e=>{let{name:t,percent:a}=e;return`${t}: ${(100*a).toFixed(0)}%`},children:q.map(((e,t)=>(0,R.jsx)(S.f,{fill:I[t%I.length]},`cell-${t}`)))}),(0,R.jsx)(g.m,{formatter:e=>[`${e} \u6761\u5efa\u8bae`,"\u6570\u91cf"]}),(0,R.jsx)(A.s,{})]})})})}),(0,R.jsx)(o.A,{xs:24,sm:24,md:12,children:(0,R.jsx)(h.A,{title:"\u5efa\u8bae\u7c7b\u578b\u5206\u5e03",bodyStyle:{padding:X?8:24},children:(0,R.jsx)(u.u,{width:"100%",height:X?250:300,children:(0,R.jsxs)(b.r,{children:[(0,R.jsx)(v.F,{data:G,cx:"50%",cy:"50%",labelLine:!X,outerRadius:X?60:80,fill:"#8884d8",dataKey:"value",nameKey:"name",label:X?null:e=>{let{name:t,percent:a}=e;return`${t}: ${(100*a).toFixed(0)}%`},children:G.map(((e,t)=>(0,R.jsx)(S.f,{fill:I[t%I.length]},`cell-${t}`)))}),(0,R.jsx)(g.m,{formatter:e=>[`${e} \u6761\u5efa\u8bae`,"\u6570\u91cf"]}),(0,R.jsx)(A.s,{})]})})})}),(0,R.jsx)(o.A,{xs:24,sm:24,md:12,children:(0,R.jsx)(h.A,{title:"\u5efa\u8bae\u72b6\u6001\u5206\u5e03",bodyStyle:{padding:X?8:24},children:(0,R.jsx)(u.u,{width:"100%",height:X?250:300,children:(0,R.jsxs)(b.r,{children:[(0,R.jsx)(v.F,{data:T,cx:"50%",cy:"50%",labelLine:!X,outerRadius:X?60:80,fill:"#8884d8",dataKey:"value",nameKey:"name",label:X?null:e=>{let{name:t,percent:a}=e;return`${t}: ${(100*a).toFixed(0)}%`},children:T.map(((e,t)=>(0,R.jsx)(S.f,{fill:I[t%I.length]},`cell-${t}`)))}),(0,R.jsx)(g.m,{formatter:e=>[`${e} \u6761\u5efa\u8bae`,"\u6570\u91cf"]}),(0,R.jsx)(A.s,{})]})})})}),(0,R.jsx)(o.A,{xs:24,sm:24,md:12,children:(0,R.jsx)(h.A,{title:"\u90e8\u95e8\u5206\u5e03",bodyStyle:{padding:X?8:24},children:(0,R.jsx)(u.u,{width:"100%",height:X?250:300,children:(0,R.jsxs)(w.E,{data:N,margin:{top:5,right:30,left:X?0:20,bottom:5},children:[(0,R.jsx)(j.d,{strokeDasharray:"3 3"}),(0,R.jsx)(y.W,{dataKey:"name"}),(0,R.jsx)(p.h,{}),(0,R.jsx)(g.m,{}),(0,R.jsx)(A.s,{}),(0,R.jsx)(k.y,{dataKey:"value",name:"\u5efa\u8bae\u6570\u91cf",fill:"#8884d8"})]})})})}),(0,R.jsx)(o.A,{span:24,children:(0,R.jsx)(h.A,{title:"\u5efa\u8bae\u8d21\u732e\u6392\u884c\u699c",bodyStyle:{padding:X?8:24},children:(0,R.jsx)(x.A,{dataSource:J,columns:[{title:"\u6392\u540d",dataIndex:"rank",key:"rank",width:80,render:(e,t,a)=>a+1},{title:"\u59d3\u540d",dataIndex:"name",key:"name"},{title:"\u6240\u5c5e\u73ed\u7ec4",dataIndex:"team",key:"team"},{title:"\u5efa\u8bae\u6570\u91cf",dataIndex:"count",key:"count",sorter:(e,t)=>e.count-t.count},{title:"\u91c7\u7eb3\u7387",dataIndex:"adoptionRate",key:"adoptionRate",render:e=>`${e}%`,sorter:(e,t)=>e.adoptionRate-t.adoptionRate}],rowKey:"id",pagination:{pageSize:X?5:10},scroll:{x:X?500:void 0},size:X?"small":"middle"})})})]})})]})}}}]);
//# sourceMappingURL=941.01542eb6.chunk.js.map