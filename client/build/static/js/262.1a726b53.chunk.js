"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[262],{19119:(e,t,s)=>{s.r(t),s.d(t,{IMPLEMENTATION_STATUS:()=>a,IMPLEMENTATION_STATUS_COLORS:()=>l,IMPLEMENTATION_STATUS_TRANSITIONS:()=>i,REVIEW_LEVELS:()=>g,REVIEW_RESULTS:()=>u,REVIEW_STATUS:()=>n,REVIEW_STATUS_COLORS:()=>o,REVIEW_STATUS_TRANSITIONS:()=>r,STATUS_COLORS:()=>E,SUGGESTION_STATUS:()=>c,SUGGESTION_TYPES:()=>d,TYPE_COLORS:()=>p});const n={PENDING_FIRST_REVIEW:"\u7b49\u5f85\u4e00\u7ea7\u5ba1\u6838",PENDING_SECOND_REVIEW:"\u7b49\u5f85\u4e8c\u7ea7\u5ba1\u6838",APPROVED:"\u5df2\u6279\u51c6",REJECTED:"\u5df2\u9a73\u56de"},o={PENDING_FIRST_REVIEW:"gold",PENDING_SECOND_REVIEW:"orange",APPROVED:"green",REJECTED:"red"},r={PENDING_FIRST_REVIEW:["APPROVED","REJECTED"],PENDING_SECOND_REVIEW:["APPROVED","REJECTED"],APPROVED:[],REJECTED:["PENDING_FIRST_REVIEW"]},a={NOT_STARTED:"\u672a\u5f00\u59cb",CONTACTING:"\u8054\u7cfb\u4e2d",IN_PROGRESS:"\u5b9e\u65bd\u4e2d",DELAYED:"\u5ef6\u671f",COMPLETED:"\u5df2\u5b8c\u6210",CANCELLED:"\u5df2\u53d6\u6d88"},i={NOT_STARTED:["CONTACTING","CANCELLED"],CONTACTING:["IN_PROGRESS","CANCELLED"],IN_PROGRESS:["COMPLETED","DELAYED","CANCELLED"],DELAYED:["IN_PROGRESS","COMPLETED","CANCELLED"],COMPLETED:[],CANCELLED:["CONTACTING"]},l={NOT_STARTED:"gold",CONTACTING:"processing",IN_PROGRESS:"warning",DELAYED:"orange",COMPLETED:"success",CANCELLED:"red"},c={PENDING_FIRST_REVIEW:"\u7b49\u5f85\u4e00\u7ea7\u5ba1\u6838",PENDING_SECOND_REVIEW:"\u7b49\u5f85\u4e8c\u7ea7\u5ba1\u6838",APPROVED:"\u5df2\u6279\u51c6",REJECTED:"\u5df2\u9a73\u56de",NOT_STARTED:"\u672a\u5f00\u59cb",NOT_IMPLEMENTED:"\u5df2\u6279\u51c6\u5f85\u5b9e\u65bd",IMPLEMENTING:"\u5b9e\u65bd\u4e2d",DELAYED:"\u5b9e\u65bd\u5ef6\u671f",COMPLETED:"\u5df2\u5b8c\u6210",CANCELLED:"\u5df2\u53d6\u6d88"},d={SAFETY:"\u8c03\u5ea6\u5b89\u5168\u7c7b",ELECTRICAL:"\u8bbe\u5907\u7535\u6c14\u7c7b",MECHANICAL:"\u8bbe\u5907\u673a\u68b0\u7c7b",KEXIN_AUTOMATION:"\u79d1\u4fe1\u81ea\u52a8\u5316\u7c7b",KEXIN_MONITORING:"\u79d1\u4fe1\u76d1\u63a7\u7c7b",OTHER:"\u5176\u5b83\u7c7b"},g={FIRST_LEVEL:"\u4e00\u7ea7\u5ba1\u6838",SECOND_LEVEL:"\u4e8c\u7ea7\u5ba1\u6838"},u={PENDING:"\u5f85\u5ba1\u6838",APPROVED:"\u901a\u8fc7",REJECTED:"\u62d2\u7edd"},E={PENDING_FIRST_REVIEW:"gold",PENDING_SECOND_REVIEW:"orange",APPROVED:"green",REJECTED:"red",NOT_STARTED:"default",NOT_IMPLEMENTED:"cyan",IMPLEMENTING:"blue",DELAYED:"purple",COMPLETED:"green",CANCELLED:"magenta"},p={SAFETY:"volcano",ELECTRICAL:"geekblue",MECHANICAL:"orange",KEXIN_AUTOMATION:"cyan",KEXIN_MONITORING:"red",OTHER:"purple"}},26510:(e,t,s)=>{s.d(t,{O:()=>a});var n=s(94505),o=s(86213);const r="/suggestions",a={getCreateData:async()=>{try{return await n.A.get("/suggestions/create")}catch(e){throw console.error("\u83b7\u53d6\u521b\u5efa\u5efa\u8bae\u6570\u636e\u5931\u8d25:",e),e}},submitSuggestion:async e=>{try{console.log("\u63d0\u4ea4\u5efa\u8bae\uff0c\u8868\u5355\u6570\u636e:",e);const t=await n.A.post("/suggestions",e,{headers:{"Content-Type":void 0}});return console.log("\u63d0\u4ea4\u5efa\u8bae\u54cd\u5e94:",t),t}catch(s){var t;throw console.error("\u63d0\u4ea4\u5efa\u8bae\u5931\u8d25:",s),console.error("\u9519\u8bef\u54cd\u5e94:",null===(t=s.response)||void 0===t?void 0:t.data),s}},getSuggestions:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{console.log("suggestionService.getSuggestions - params:",e);const t=new URLSearchParams(e).toString();console.log("suggestionService.getSuggestions - queryString:",t);const s=await n.A.get(`/suggestions?${t}`);console.log("suggestionService.getSuggestions - \u539f\u59cb\u54cd\u5e94:",s);let o={data:[],pagination:{current:parseInt(e.page)||1,pageSize:parseInt(e.limit)||10,total:0}};if(s&&s.data&&Array.isArray(s.data.suggestions))console.log("\u683c\u5f0f1: response.data = { suggestions: [...], pagination: {...} }"),o.data=s.data.suggestions,s.data.pagination&&(o.pagination={current:parseInt(s.data.pagination.current)||o.pagination.current,pageSize:parseInt(s.data.pagination.pageSize)||o.pagination.pageSize,total:parseInt(s.data.pagination.total)||o.pagination.total});else if(s&&Array.isArray(s.data))console.log("\u683c\u5f0f2: response.data = [...]"),o.data=s.data,o.pagination.total=s.data.length;else if(s&&s.data&&s.data.data&&Array.isArray(s.data.data))console.log("\u683c\u5f0f3: response.data.data = [...]"),o.data=s.data.data,s.data.pagination?o.pagination={current:parseInt(s.data.pagination.current)||o.pagination.current,pageSize:parseInt(s.data.pagination.pageSize)||o.pagination.pageSize,total:parseInt(s.data.pagination.total)||o.pagination.total}:o.pagination.total=s.data.data.length;else if(console.warn("suggestionService.getSuggestions - \u672a\u77e5\u54cd\u5e94\u7ed3\u6784:",s),s&&"object"===typeof s){const e=Object.entries(s).find((e=>{let[t,s]=e;return Array.isArray(s)}));e&&(console.log(`\u627e\u5230\u53ef\u80fd\u7684\u6570\u636e\u6570\u7ec4: ${e[0]}`),o.data=e[1],o.pagination.total=e[1].length);const t=Object.entries(s).find((e=>{let[t,s]=e;return"object"===typeof s&&null!==s&&("pagination"===t||"page"===t||"paging"===t)}));if(t){console.log(`\u627e\u5230\u53ef\u80fd\u7684\u5206\u9875\u4fe1\u606f: ${t[0]}`);const e=t[1];o.pagination={current:parseInt(e.current||e.page||e.currentPage||1),pageSize:parseInt(e.pageSize||e.limit||e.size||10),total:parseInt(e.total||e.totalCount||e.totalItems||0)}}}return console.log("suggestionService.getSuggestions - \u5904\u7406\u540e\u7684\u7ed3\u679c:",o),o}catch(s){var t;throw console.error("\u83b7\u53d6\u5efa\u8bae\u5217\u8868\u5931\u8d25:",(null===(t=s.response)||void 0===t?void 0:t.data)||s.message),s}},getSuggestionById:async e=>{try{const t=await n.A.get(`/suggestions/${e}`);return t&&t.data?{data:i(t.data)}:t?{data:i(t)}:t}catch(t){throw console.error("\u83b7\u53d6\u5efa\u8bae\u8be6\u60c5\u5931\u8d25:",t),t}},updateSuggestionStatus:async(e,t,s)=>{try{return await n.A.put(`/suggestions/${e}/status`,{status:t,comment:s})}catch(o){throw console.error("\u66f4\u65b0\u5efa\u8bae\u72b6\u6001\u5931\u8d25:",o),o}},firstReview:async(e,t,s)=>{try{console.log("\u63d0\u4ea4\u4e00\u7ea7\u5ba1\u6838:",e,"\u5ba1\u6838\u7ed3\u679c:",t,"\u5ba1\u6838\u610f\u89c1:",s);const o=await n.A.put(`/suggestions/${e}/first-review`,{result:t,comments:s});return console.log("\u4e00\u7ea7\u5ba1\u6838\u54cd\u5e94:",o),o}catch(r){var o;throw console.error("\u4e00\u7ea7\u5ba1\u6838\u5931\u8d25:",r),console.error("\u9519\u8bef\u8be6\u60c5:",null===(o=r.response)||void 0===o?void 0:o.data),r}},secondReview:async(e,t,s)=>{try{console.log("\u63d0\u4ea4\u4e8c\u7ea7\u5ba1\u6838:",e,"\u5ba1\u6838\u7ed3\u679c:",t,"\u5ba1\u6838\u610f\u89c1:",s);const o=await n.A.put(`/suggestions/${e}/second-review`,{result:t,comments:s});return console.log("\u4e8c\u7ea7\u5ba1\u6838\u54cd\u5e94:",o),o}catch(r){var o;throw console.error("\u4e8c\u7ea7\u5ba1\u6838\u5931\u8d25:",r),console.error("\u9519\u8bef\u8be6\u60c5:",null===(o=r.response)||void 0===o?void 0:o.data),r}},updateSuggestion:async(e,t)=>{try{console.log("\u66f4\u65b0\u5efa\u8bae:",e,t);return await n.A.put(`/suggestions/${e}`,t)}catch(s){throw console.error("\u66f4\u65b0\u5efa\u8bae\u5931\u8d25:",s),s}},addComment:async(e,t)=>{try{return await n.A.post(`/suggestions/${e}/comments`,{content:t})}catch(s){throw console.error("\u6dfb\u52a0\u8bc4\u8bba\u5931\u8d25:",s),s}},getAllSuggestions:async()=>{try{return(await o.A.get(r)).data}catch(e){throw console.error("\u83b7\u53d6\u5efa\u8bae\u5217\u8868\u5931\u8d25:",e),e}},getSuggestion:async e=>{try{return(await o.A.get(`${r}/${e}`)).data}catch(t){throw console.error("\u83b7\u53d6\u5efa\u8bae\u8be6\u60c5\u5931\u8d25:",t),t}},createSuggestion:async e=>{try{return(await o.A.post(r,e)).data}catch(t){throw console.error("\u521b\u5efa\u5efa\u8bae\u5931\u8d25:",t),t}},deleteSuggestion:async e=>{try{console.log(`\u5c1d\u8bd5\u5220\u9664\u5efa\u8bae: ${e}`);const t=await n.A.delete(`/suggestions/${e}`);return console.log("\u5220\u9664\u5efa\u8bae\u54cd\u5e94:",t),t&&!0===t.success?{success:!0,message:t.message}:(console.warn("\u5220\u9664\u6210\u529f\u4f46\u54cd\u5e94\u683c\u5f0f\u4e0d\u7b26\u5408\u9884\u671f:",t),{success:!1,message:(null===t||void 0===t?void 0:t.message)||"\u5220\u9664\u5931\u8d25\uff0c\u54cd\u5e94\u683c\u5f0f\u9519\u8bef"})}catch(r){var t,s,o;return console.error(`\u5220\u9664\u5efa\u8bae ${e} \u5931\u8d25:`,r),console.error("\u9519\u8bef\u54cd\u5e94:",null===(t=r.response)||void 0===t?void 0:t.data),{success:!1,message:(null===(s=r.response)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.message)||"\u5220\u9664\u5efa\u8bae\u65f6\u53d1\u751f\u7f51\u7edc\u6216\u670d\u52a1\u5668\u9519\u8bef"}}},submitForReview:async e=>{try{return(await o.A.post(`${r}/${e}/submit`)).data}catch(t){throw console.error("\u63d0\u4ea4\u5efa\u8bae\u5ba1\u6838\u5931\u8d25:",t),t}},reviewSuggestion:async(e,t)=>{try{return(await o.A.post(`${r}/${e}/review`,t)).data}catch(s){throw console.error("\u5ba1\u6838\u5efa\u8bae\u5931\u8d25:",s),s}},updateImplementation:async(e,t)=>{try{const s={"\u672a\u5f00\u59cb":"NOT_STARTED","\u8054\u7cfb\u4e2d":"CONTACTING","\u5b9e\u65bd\u4e2d":"IN_PROGRESS","\u5df2\u5b8c\u6210":"COMPLETED","\u53d6\u6d88":"CANCELLED"},o={...t,status:s[t.status]||t.status};delete o.evaluation,console.log("\u53d1\u9001\u5b9e\u65bd\u66f4\u65b0\u8bf7\u6c42 (suggestionService):",e,o);const a=await n.A.put(`${r}/${e}/implementation`,o);return console.log("\u5b9e\u65bd\u66f4\u65b0\u54cd\u5e94:",a),{success:!0,message:"\u5b9e\u65bd\u72b6\u6001\u66f4\u65b0\u6210\u529f",data:a.data||a}}catch(i){var s,o,a;return console.error("\u66f4\u65b0\u5b9e\u65bd\u72b6\u6001\u5931\u8d25 (suggestionService):",i),console.error("\u9519\u8bef\u54cd\u5e94:",null===(s=i.response)||void 0===s?void 0:s.data),{success:!1,message:(null===(o=i.response)||void 0===o||null===(a=o.data)||void 0===a?void 0:a.message)||"\u66f4\u65b0\u5b9e\u65bd\u72b6\u6001\u5931\u8d25",error:i}}},getImplementationStats:async()=>{try{return(await o.A.get(`${r}/stats/implementation`)).data}catch(e){throw console.error("\u83b7\u53d6\u5b9e\u65bd\u7edf\u8ba1\u6570\u636e\u5931\u8d25:",e),e}},submitReview:async e=>{try{return await n.A.post("/suggestions/review",e)}catch(t){throw t}},scoreSuggestion:async(e,t)=>{try{return await n.A.post(`/suggestions/${e}/score`,{score:t})}catch(s){throw console.error(`\u5efa\u8bae ${e} \u6253\u5206\u5931\u8d25:`,s),s}}};function i(e){if(!e)return{};let t=e.implementation;var n;t?t={...t,status:t.status||"NOT_STARTED",responsiblePerson:t.responsiblePerson||(null===(n=t.implementer)||void 0===n?void 0:n.name)||("string"===typeof t.implementer?t.implementer:"\u672a\u5206\u914d"),startDate:t.startDate||null,plannedEndDate:t.plannedCompletionDate||t.plannedEndDate||null,actualEndDate:t.actualCompletionDate||t.actualEndDate||null,notes:t.notes||t.comments||"",history:t.history||[]}:t={status:"NOT_STARTED",responsiblePerson:"\u672a\u5206\u914d",startDate:null,plannedEndDate:null,actualEndDate:null,notes:"",history:[]};let o=e.reviewStatus||e.status,r=e.implementationStatus||(t?t.status:"NOT_STARTED");const{REVIEW_STATUS:a,IMPLEMENTATION_STATUS:i}=s(19119);return a[o]&&(o=a[o]),i[r]&&(r=i[r]),{...e,reviewStatus:o,implementationStatus:r,implementation:t,submitter:e.submitter||{name:"\u672a\u77e5",_id:null},comments:Array.isArray(e.comments)?e.comments.map((e=>({...e,user:e.user||{name:"\u672a\u77e5\u7528\u6237"},createdAt:e.createdAt||(new Date).toISOString()}))):[]}}},68262:(e,t,s)=>{s.r(t),s.d(t,{default:()=>_});var n=s(65043),o=s(84892),r=s(25676),a=s(50289),i=s(48193),l=s(89421),c=s(8387),d=s(64435),g=s(26655),u=s(44394),E=s(15832),p=s(98166),S=s(33946),y=s(95862),A=s(33307),T=s(47419),I=s(11645),m=s(73216),N=s(36091),h=s(26510),x=s(78816),v=s(19119),D=s(81015),C=s(70579);const{Title:R,Text:f,TextArea:O}=o.A,{TabPane:w}=r.A,_=()=>{const e=(0,m.Zp)(),[t,s]=(0,n.useState)([]),[o,f]=(0,n.useState)(!0),[O,_]=(0,n.useState)(null),[L,P]=(0,n.useState)(""),[j,G]=(0,n.useState)(!1),[b,z]=(0,n.useState)(null),[V]=a.A.useForm(),[F,M]=(0,n.useState)(""),[k,W]=(0,n.useState)({field:null,order:null}),[U,$]=(0,n.useState)(window.innerWidth<=768);(0,n.useEffect)((()=>{const e=()=>{$(window.innerWidth<=768)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const Y="\u503c\u73ed\u4e3b\u4efb"===(null===O||void 0===O?void 0:O.role),q="\u5b89\u5168\u79d1\u7ba1\u7406\u4eba\u5458"===(null===O||void 0===O?void 0:O.role),J="\u8fd0\u884c\u79d1\u7ba1\u7406\u4eba\u5458"===(null===O||void 0===O?void 0:O.role),B="\u90e8\u95e8\u7ecf\u7406"===(null===O||void 0===O?void 0:O.role),K=Y||B,H=q||J||B;(0,n.useEffect)((()=>{(async()=>{try{const t=await x.y.getCurrentUser();if(!t)return i.Ay.error("\u8bf7\u5148\u767b\u5f55"),void e("/login");_(t)}catch(t){console.error("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25:",t),i.Ay.error("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25"),e("/login")}})()}),[e]),(0,n.useEffect)((()=>{O&&(K?P("first"):H&&P("second"))}),[O,K,H]);const X=(0,n.useCallback)((async()=>{try{f(!0);const e={};k.field&&k.order&&(e.sortBy=k.field,e.sortOrder="ascend"===k.order?"asc":"desc"),console.log("Fetching suggestions with params:",e);const t=await h.O.getSuggestions(e);console.log("\u83b7\u53d6\u5230\u7684\u5efa\u8bae\u5217\u8868 (ReviewList):",t);let n=[];t&&t.data&&Array.isArray(t.data)?n=t.data:t&&Array.isArray(t)&&(n=t),console.log("\u8bbe\u7f6e\u5f85\u5ba1\u6838\u5217\u8868 (ReviewList):",n),s(n)}catch(e){console.error("\u83b7\u53d6\u5f85\u5ba1\u6838\u5efa\u8bae\u5931\u8d25:",e),i.Ay.error("\u83b7\u53d6\u5f85\u5ba1\u6838\u5efa\u8bae\u5931\u8d25"),s([])}finally{f(!1)}}),[O,e,k.field,k.order]);(0,n.useEffect)((()=>{O&&X()}),[O,X]);const Z=t=>{e(`/suggestions/${t}`)},Q=(e,t)=>{z(e),M(t),G(!0)},ee=[{title:"\u6807\u9898",dataIndex:"title",key:"title",sorter:!0,render:(e,t)=>(0,C.jsx)(l.A,{type:"link",onClick:()=>Z(t._id),style:{fontSize:"14px",padding:"0",textAlign:"left",height:"auto",lineHeight:"normal"},children:(0,C.jsx)("span",{style:{whiteSpace:"normal",wordBreak:"break-word"},children:e})})},{title:"\u7c7b\u578b",dataIndex:"type",key:"type",sorter:!0,render:e=>(0,C.jsx)(c.A,{color:v.TYPE_COLORS[e]||"default",style:{padding:"4px 8px",borderRadius:"4px",fontSize:"14px"},children:v.SUGGESTION_TYPES[e]||e})},{title:"\u72b6\u6001",dataIndex:"status",key:"status",sorter:!0,render:(e,t)=>{const s=(0,D.q)(t),n=v.STATUS_COLORS[s]||"default";return(0,C.jsx)(c.A,{color:n,style:{padding:"4px 8px",borderRadius:"4px",fontSize:"14px"},children:v.SUGGESTION_STATUS[s]||s})}},{title:"\u5f97\u5206",dataIndex:["scoring","score"],key:"score",sorter:(e,t)=>{var s,n;const o=null===(s=e.scoring)||void 0===s?void 0:s.score,r=null===(n=t.scoring)||void 0===n?void 0:n.score;return void 0!==o&&null!==o&&void 0!==r&&null!==r?o-r:void 0===o||null===o?1:void 0===r||null===r?-1:0},render:e=>(0,C.jsx)("span",{style:{fontSize:"14px"},children:"number"===typeof e?e.toFixed(1):"-"})},{title:"\u63d0\u4ea4\u4eba",dataIndex:"submitter",key:"submitter",sorter:!0,render:e=>(0,C.jsx)("span",{style:{fontSize:"14px"},children:(null===e||void 0===e?void 0:e.name)||"\u672a\u77e5"})},{title:"\u73ed\u7ec4",dataIndex:"team",key:"team",sorter:!0,render:e=>(0,C.jsx)("span",{style:{fontSize:"14px"},children:e})},{title:"\u63d0\u4ea4\u65f6\u95f4",dataIndex:"createdAt",key:"createdAt",sorter:!0,render:e=>(0,C.jsx)("span",{style:{fontSize:"14px"},children:e?new Date(e).toLocaleString():"\u672a\u77e5"})},{title:"\u64cd\u4f5c",key:"action",render:(e,t)=>{const s=(0,D.q)(t),n="PENDING_FIRST_REVIEW"===s&&(Y||B)&&(0,C.jsx)(l.A,{type:"primary",onClick:()=>Q(t,"first"),style:{fontSize:"14px"},children:"\u4e00\u7ea7\u5ba1\u6838"}),o="PENDING_SECOND_REVIEW"===s&&(q&&("\u5b89\u5168\u7ba1\u7406"===t.type||"SAFETY"===t.type)||J&&"\u5b89\u5168\u7ba1\u7406"!==t.type&&"SAFETY"!==t.type||B)&&(0,C.jsx)(l.A,{type:"primary",onClick:()=>Q(t,"second"),style:{fontSize:"14px"},children:"\u4e8c\u7ea7\u5ba1\u6838"});return(0,C.jsxs)(d.A,{children:[n,o,(0,C.jsx)(l.A,{type:"default",icon:(0,C.jsx)(N.A,{}),onClick:()=>Z(t._id),style:{fontSize:"14px"},children:"\u67e5\u770b\u8be6\u60c5"})]})}}],te=[{title:"\u5efa\u8bae\u4fe1\u606f",dataIndex:"title",key:"title",render:(e,t)=>{var s;const n=(0,D.q)(t),o="PENDING_FIRST_REVIEW"===n&&(Y||B),r="PENDING_SECOND_REVIEW"===n&&(q&&("\u5b89\u5168\u7ba1\u7406"===t.type||"SAFETY"===t.type)||J&&"\u5b89\u5168\u7ba1\u7406"!==t.type&&"SAFETY"!==t.type||B);return(0,C.jsxs)("div",{style:{padding:"8px 0"},children:[(0,C.jsx)("div",{style:{fontSize:"16px",fontWeight:"bold",marginBottom:"8px"},children:e}),(0,C.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginBottom:"10px"},children:[(0,C.jsx)(c.A,{color:v.TYPE_COLORS[t.type]||"default",style:{padding:"2px 6px",fontSize:"12px"},children:v.SUGGESTION_TYPES[t.type]||t.type}),(0,C.jsx)(c.A,{color:v.STATUS_COLORS[n]||"default",style:{padding:"2px 6px",fontSize:"12px"},children:v.SUGGESTION_STATUS[n]||n})]}),(0,C.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:"#888",marginBottom:"10px"},children:[(0,C.jsxs)("span",{children:[(null===(s=t.submitter)||void 0===s?void 0:s.name)||"\u672a\u77e5"," (",t.team||"\u672a\u77e5\u73ed\u7ec4",")"]}),(0,C.jsx)("span",{children:t.createdAt?new Date(t.createdAt).toLocaleDateString():"\u672a\u77e5"})]}),(0,C.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:"10px"},children:[o&&(0,C.jsx)(l.A,{type:"primary",size:"small",onClick:()=>Q(t,"first"),children:"\u4e00\u7ea7\u5ba1\u6838"}),r&&(0,C.jsx)(l.A,{type:"primary",size:"small",onClick:()=>Q(t,"second"),children:"\u4e8c\u7ea7\u5ba1\u6838"}),(0,C.jsx)(l.A,{type:"default",size:"small",onClick:()=>Z(t._id),children:"\u67e5\u770b\u8be6\u60c5"})]})]})}}],se=(e,t,s)=>{console.log("Table change:",e,t,s),s.field===k.field&&s.order===k.order||W({field:s.field,order:s.order})},ne=t.filter((e=>"PENDING_FIRST_REVIEW"===(0,D.q)(e))),oe=t.filter((e=>"PENDING_SECOND_REVIEW"===(0,D.q)(e)));return(0,C.jsx)("div",{className:"responsive-container",style:{padding:U?"12px":"24px"},children:(0,C.jsxs)(g.A,{bodyStyle:{padding:U?"12px":"24px"},children:[(0,C.jsx)(R,{level:U?4:3,style:{fontSize:U?"18px":"20px",marginBottom:U?"16px":"20px"},children:"\u5efa\u8bae\u5ba1\u6838\u7ba1\u7406"}),K||H?(0,C.jsxs)(r.A,{activeKey:L,onChange:P,children:[K&&(0,C.jsx)(w,{tab:(0,C.jsxs)("span",{children:["\u4e00\u7ea7\u5ba1\u6838",(0,C.jsx)(E.A,{count:ne.length,offset:[5,-5],style:{backgroundColor:"#FF4D4F"}})]}),children:0===ne.length?(0,C.jsx)(u.A,{message:"\u6682\u65e0\u5f85\u5ba1\u6838\u5efa\u8bae",description:"\u5f53\u524d\u6ca1\u6709\u9700\u8981\u8fdb\u884c\u4e00\u7ea7\u5ba1\u6838\u7684\u5efa\u8bae",type:"info",showIcon:!0}):(0,C.jsx)(p.A,{columns:U?te:ee,dataSource:ne,rowKey:"_id",loading:o,pagination:{pageSize:U?5:10},style:{fontSize:U?"13px":"14px"},className:"suggestions-table",bordered:!0,rowClassName:()=>"suggestion-row",onChange:se,scroll:{},size:U?"small":"default"})},"first"),H&&(0,C.jsx)(w,{tab:(0,C.jsxs)("span",{children:["\u4e8c\u7ea7\u5ba1\u6838",(0,C.jsx)(E.A,{count:oe.length,offset:[5,-5],style:{backgroundColor:"#FF4D4F"}})]}),children:0===oe.length?(0,C.jsx)(u.A,{message:"\u6682\u65e0\u5f85\u5ba1\u6838\u5efa\u8bae",description:"\u5f53\u524d\u6ca1\u6709\u9700\u8981\u8fdb\u884c\u4e8c\u7ea7\u5ba1\u6838\u7684\u5efa\u8bae",type:"info",showIcon:!0}):(0,C.jsx)(p.A,{columns:U?te:ee,dataSource:oe,rowKey:"_id",loading:o,pagination:{pageSize:U?5:10},style:{fontSize:U?"13px":"14px"},className:"suggestions-table",bordered:!0,rowClassName:()=>"suggestion-row",onChange:se,scroll:{},size:U?"small":"default"})},"second")]}):(0,C.jsx)(u.A,{message:"\u65e0\u8bbf\u95ee\u6743\u9650",description:"\u60a8\u6ca1\u6709\u6743\u9650\u8bbf\u95ee\u5ba1\u6838\u7ba1\u7406\u9875\u9762",type:"error",showIcon:!0}),(0,C.jsx)(S.A,{title:("first"===F?"\u4e00\u7ea7":"\u4e8c\u7ea7")+"\u5ba1\u6838",visible:j,onCancel:()=>{G(!1),V.resetFields()},footer:null,bodyStyle:{fontSize:"14px"},width:U?"95%":520,children:(0,C.jsxs)(a.A,{form:V,onFinish:async e=>{try{const{result:t,comment:s}=e,n={suggestionId:b._id,reviewType:F,comment:s,result:t,reviewerId:O._id};console.log("\u63d0\u4ea4\u5ba1\u6838\u6570\u636e:",JSON.stringify(n,null,2)),console.log("\u5f53\u524d\u5efa\u8bae\u72b6\u6001:",b.status),console.log("\u5f53\u524d\u7528\u6237\u89d2\u8272:",null===O||void 0===O?void 0:O.role),console.log("\u5f53\u524d\u7528\u6237\u73ed\u7ec4:",null===O||void 0===O?void 0:O.team),console.log("\u5efa\u8bae\u6240\u5c5e\u73ed\u7ec4:",b.team),console.log("\u5efa\u8bae\u7c7b\u578b:",b.type),await h.O.submitReview(n),i.Ay.success("\u5ba1\u6838\u63d0\u4ea4\u6210\u529f"),G(!1),V.resetFields(),X(),setTimeout((()=>{X()}),2e3)}catch(n){var t,s;console.error("\u5ba1\u6838\u63d0\u4ea4\u5931\u8d25:",n),i.Ay.error("\u5ba1\u6838\u63d0\u4ea4\u5931\u8d25"+((null===(t=n.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||""))}},layout:"vertical",children:[(0,C.jsx)(a.A.Item,{name:"result",label:"\u5ba1\u6838\u7ed3\u679c",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5ba1\u6838\u7ed3\u679c"}],children:(0,C.jsxs)(y.Ay.Group,{style:{fontSize:"14px"},children:[(0,C.jsx)(y.Ay,{value:"approve",children:"\u901a\u8fc7"}),(0,C.jsx)(y.Ay,{value:"reject",children:"\u62d2\u7edd"})]})}),(0,C.jsx)(a.A.Item,{name:"comment",label:"\u5ba1\u6838\u610f\u89c1",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5ba1\u6838\u610f\u89c1"}],children:(0,C.jsx)(A.A.TextArea,{rows:U?3:4,style:{fontSize:"14px"}})}),(0,C.jsx)(a.A.Item,{children:(0,C.jsxs)(T.A,{gutter:16,children:[(0,C.jsx)(I.A,{span:U?12:8,children:(0,C.jsx)(l.A,{type:"primary",htmlType:"submit",style:{width:"100%",fontSize:"14px"},children:"\u63d0\u4ea4"})}),(0,C.jsx)(I.A,{span:U?12:8,children:(0,C.jsx)(l.A,{onClick:()=>{G(!1),V.resetFields()},style:{width:"100%",fontSize:"14px"},children:"\u53d6\u6d88"})})]})})]})})]})})}},81015:(e,t,s)=>{s.d(t,{q:()=>o});var n=s(19119);const o=e=>{if(!e)return"";const t=e.reviewStatus||e.status;if("string"===typeof t&&/[\u4e00-\u9fa5]/.test(t)){const e=Object.entries(n.REVIEW_STATUS).find((e=>{let[s,n]=e;return n===t}));return e?e[0]:t}return t}}}]);
//# sourceMappingURL=262.1a726b53.chunk.js.map